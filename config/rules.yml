# 动力学规则配置文件
# 定义状态监听与响应机制

rules:
  # 规则1: 需求安全等级提升触发强制审查
  - id: rule_001
    name: 高安全等级需求强制审查
    description: 当需求的安全等级提升为A级时,自动启用相关代码分支的强制审查
    priority: 100
    condition:
      object_type: requirement
      attribute: security_level
      operator: equals
      value: A
    actions:
      - action: 启用强制审查
        target: branch_auth_feature
        params:
          review_level: strict
      - action: 发送通知
        target: $source
        params:
          message: 需求已升级为A级安全等级,已启用强制审查流程

  # 规则2: 高安全等级需求预约高精度测试台
  - id: rule_002
    name: 高安全等级需求预约精密测试台
    description: 当需求为A级安全等级时,自动预约嵌入式半实物仿真台
    priority: 90
    condition:
      object_type: requirement
      attribute: security_level
      operator: equals
      value: A
    actions:
      - action: 预约测试台
        target: testbed_sim_01
        params:
          platform: embedded_simulation
          reserved_by: auto_scheduler
      - action: 上电
        target: testbed_sim_01
        params: {}

  # 规则3: 强制审查启用后执行代码分析
  - id: rule_003
    name: 强制审查触发静态分析
    description: 当代码分支启用强制审查后,自动触发静态代码分析
    priority: 80
    condition:
      object_type: code_branch
      attribute: review_required
      operator: equals
      value: true
    actions:
      - action: 发送通知
        target: $source
        params:
          message: 已启用强制审查,请开发团队注意

  # 规则4: 缺陷严重程度为高时的处理
  - id: rule_004
    name: 高严重程度缺陷快速响应
    description: 当缺陷严重程度为高时,发送紧急通知
    priority: 95
    condition:
      object_type: defect
      attribute: severity
      operator: equals
      value: high
    actions:
      - action: 发送通知
        target: $source
        params:
          message: 发现高严重程度缺陷,请立即处理

  # 规则5: 测试台预约后自动加载固件
  - id: rule_005
    name: 测试台预约后准备环境
    description: 测试台被预约后,自动加载最新固件
    priority: 70
    condition:
      object_type: test_platform
      attribute: reserved_for
      operator: not_equals
      value: null
    actions:
      - action: 加载固件
        target: $source
        params:
          firmware_version: latest
